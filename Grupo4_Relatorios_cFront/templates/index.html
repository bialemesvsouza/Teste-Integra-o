<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Relat√≥rios de Empr√©stimos</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <h1>üìö Relat√≥rios de Biblioteca</h1>

  <section>
    <h2>Livros mais emprestados</h2>
    <button onclick="loadBooks()">Atualizar</button>
    <table id="books-table">
      <thead><tr><th>ID</th><th>T√≠tulo</th><th>Empr√©stimos</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <section>
    <h2>Usu√°rios mais ativos</h2>
    <button onclick="loadUsers()">Atualizar</button>
    <table id="users-table">
      <thead><tr><th>ID</th><th>Nome</th><th>Empr√©stimos</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <script>
    async function loadBooks() {
      const res = await fetch('/report/books');
      const data = await res.json();
      const tbody = document.querySelector('#books-table tbody');
      tbody.innerHTML = data.map(r => `
        <tr><td>${r.id}</td><td>${r.title}</td><td>${r.count}</td></tr>
      `).join('');
    }

    async function loadUsers() {
      const res = await fetch('/report/users');
      const data = await res.json();
      const tbody = document.querySelector('#users-table tbody');
      tbody.innerHTML = data.map(r => `
        <tr><td>${r.id}</td><td>${r.name}</td><td>${r.count}</td></tr>
      `).join('');
    }

    loadBooks();
    loadUsers();
  </script>
</body>
</html>
